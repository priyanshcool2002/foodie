<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Foodie - Cart</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
</head>

<body>
  <!-- Navbar (same as other pages, include dynamic cartCount) -->

  <div class="container my-5">
    <h2 class="mb-4">Your Cart</h2>
    <div id="cartContainer" class="table-responsive">
      <!-- Cart items will be injected here -->
    </div>
    <div class="text-end mt-3">
      <h4>Total: ₹<span id="cartTotal">0</span></h4>
      <button class="btn btn-primary mt-3" onclick="checkout()">Checkout</button>
    </div>
  </div>

  <script>
    function renderCart() {
      const cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];
      const cartContainer = document.getElementById("cartContainer");
      const cartTotalEl = document.getElementById("cartTotal");

      if (cartItems.length === 0) {
        cartContainer.innerHTML = `<p>Your cart is empty.</p>`;
        cartTotalEl.textContent = "0";
        return;
      }

      let html = `<table class="table table-bordered">
                    <thead>
                      <tr>
                        <th>Item</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Subtotal</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody>`;

      let total = 0;
      cartItems.forEach((item, index) => {
        const subtotal = item.price * item.quantity;
        total += subtotal;

        html += `<tr>
                  <td>${item.name}</td>
                  <td>₹${item.price}</td>
                  <td>${item.quantity}</td>
                  <td>₹${subtotal}</td>
                  <td><button class="btn btn-danger btn-sm" onclick="removeItem(${index})">Remove</button></td>
                </tr>`;
      });

      html += `</tbody></table>`;
      cartContainer.innerHTML = html;
      cartTotalEl.textContent = total;
    }

    function removeItem(index) {
      let cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];
      cartItems.splice(index, 1);
      localStorage.setItem("cartItems", JSON.stringify(cartItems));
      renderCart();
      updateCartCount();
    }

    function checkout() {
      alert("Thank you! Your order has been placed.");
      localStorage.removeItem("cartItems");
      renderCart();
      updateCartCount();
    }

    function updateCartCount() {
      const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
      const cartCount = document.getElementById('cartCount');
      if (cartCount) {
        cartCount.textContent = cartItems.reduce((total, item) => total + item.quantity, 0);
      }
    }

    window.onload = function () {
      renderCart();
      updateCartCount();
    }
  </script>
</body>
</html>
